---
title: "Bayesian modeling and prediction for movies"
author: "Raymond Ngiam"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(statsr)
library(BAS)
```

### Load data

```{r load-data}
load("movies.Rdata")
```



* * *

## Part 1: Data

**How the observations in the sample are collected:**

The data set is comprised of 651 randomly sampled movies produced and released before 2016.
<br></br>

**Implications of this data collection method on the scope of inference (generalizability):**

Since the data collection involves random sampling, the sample can be considered representative of the population. Hence findings from this observational study can be generalized to the entire population.
<br></br>

**Implications of this data collection method on the scope of inference (causality):**

Since this is an observational study, not an experiment where subjects are randomly assigned for specific treatments, hence, the findings on relationship among different factors only establish association but do not imply causality.

* * *

## Part 2: Data manipulation

Entries with NA (Not Applicable) cell are removed from the dataset.
```{r}
movies_no_na <- na.omit(movies)
N = nrow(movies_no_na)
N
```

New variables are created as follows:

+ **feature_film**: "yes" if **title_type** is Feature Film, "no" otherwise
+ **drama**: "yes" if **genre** is Drama, "no" otherwise
+ **mpaa_rating_R**: "yes" if **mpaa_rating** is R, "no" otherwise
+ **oscar_season**: "yes" if movie is released in November, October, or December (based on **thtr_rel_month**), "no" otherwise
+ **summer_season**: "yes" if movie is released in May, June, July, or August (based on **thtr_rel_month**), "no" otherwise 

```{r}
movies_added_predictors <- movies_no_na %>%
  mutate(feature_film = if_else(title_type=="Feature Film","yes","no")) %>%
  mutate(drama = if_else(genre=="Drama","yes","no")) %>%
  mutate(mpaa_rating_R = if_else(mpaa_rating=="R","yes","no")) %>%
  mutate(oscar_season = if_else(is.element(thtr_rel_month,c(10,11,12)),"yes","no")) %>%
  mutate(summer_season = if_else(is.element(thtr_rel_month,c(5,6,7,8)),"yes","no"))

movies_added_predictors$feature_film = factor(movies_added_predictors$feature_film, levels = c("yes", "no"))
movies_added_predictors$drama = factor(movies_added_predictors$drama, levels = c("yes", "no"))
movies_added_predictors$mpaa_rating_R = factor(movies_added_predictors$mpaa_rating_R, levels = c("yes", "no"))
movies_added_predictors$oscar_season = factor(movies_added_predictors$oscar_season, levels = c("yes", "no"))
movies_added_predictors$summer_season = factor(movies_added_predictors$summer_season, levels = c("yes", "no"))
```

* * *

## Part 3: Exploratory data analysis

We will consider the following variables in our bayesian model selection:

+ **feature_film**
+ **drama**
+ **runtime**
+ **mpaa_rating_R**
+ **thtr_rel_year**
+ **oscar_season**
+ **summer_season**
+ **imdb_rating**
+ **imdb_num_votes**
+ **critics_score**
+ **best_pic_nom**
+ **best_pic_win**
+ **best_actor_win**
+ **best_actress_win**
+ **best_dir_win**
+ **top200_box**

Firstly, lets explore the relationship between audience_score and the new categorical variables constructed in the previous part.

1) Feature film and audience score

Box plot to visualize the differences in audience score distribution among categorical variable, **feature_film**.
```{r}
ggplot(data=movies_added_predictors, aes(x=feature_film, y=audience_score)) + 
  geom_boxplot() + 
  labs(title = "Boxplot of audience_score against feature_film")
```

Summary statistics
```{r}
movies_added_predictors %>%
  group_by(feature_film) %>%
  summarize(mean=mean(audience_score), sd=sd(audience_score),median=median(audience_score),IQR=IQR(audience_score),min=min(audience_score),max=max(audience_score), count=n())
```

<span style="color:blue">Interpretation: There is an obvious difference in the distribution of audience score between movies that belong to </span>
<span style="color:blue;font-weight:bold">feature_film</span>
<span style="color:blue"> category and those that do not. The </span>
<span style="color:blue;font-weight:bold">feature_film</span>
<span style="color:blue"> title type has lower audience score by 21.966 on average compared to the rest.</span>
<br> </br>

2) Drama and audience score

Box plot to visualize the differences in audience score distribution among categorical variable, **drama**.
```{r}
ggplot(data=movies_added_predictors, aes(x=drama, y=audience_score)) + 
  geom_boxplot() + 
  labs(title = "Boxplot of audience_score against drama")
```

Summary statistics
```{r}
movies_added_predictors %>%
  group_by(drama) %>%
  summarize(mean=mean(audience_score), sd=sd(audience_score),median=median(audience_score),IQR=IQR(audience_score),min=min(audience_score),max=max(audience_score), count=n())
```

<span style="color:blue">Interpretation: There is an obvious difference in the distribution of audience score between movies that belong to </span>
<span style="color:blue;font-weight:bold">drama</span>
<span style="color:blue"> category and those that do not. The </span>
<span style="color:blue;font-weight:bold">drama</span>
<span style="color:blue"> genre has higher audience score by 5.937 on average compared to the rest.</span>
<br> </br>

3) MPAA R Rating and audience score

Box plot to visualize the differences in audience score distribution among categorical variable, **mpaa_rating_R**.
```{r}
ggplot(data=movies_added_predictors, aes(x=mpaa_rating_R, y=audience_score)) + 
  geom_boxplot() + 
  labs(title = "Boxplot of audience_score against mpaa_rating_R")
```

Summary statistics
```{r}
movies_added_predictors %>%
  group_by(mpaa_rating_R) %>%
  summarize(mean=mean(audience_score), sd=sd(audience_score),median=median(audience_score),IQR=IQR(audience_score),min=min(audience_score),max=max(audience_score), count=n())
```

<span style="color:blue">Interpretation: Apparently there is close to no difference in the distribution of audience score between movies that belong to </span>
<span style="color:blue;font-weight:bold">mpaa_rating_R</span>
<span style="color:blue"> category and those that do not. The difference of average audience score between the two classes is only 0.336, hence it is not a significant predictor.</span>
<br> </br>

4) Oscar season and audience score

Box plot to visualize the differences in audience score distribution among categorical variable, **oscar_season**.
```{r}
ggplot(data=movies_added_predictors, aes(x=oscar_season, y=audience_score)) + 
  geom_boxplot() + 
  labs(title = "Boxplot of audience_score against oscar_season")
```

Summary statistics
```{r}
movies_added_predictors %>%
  group_by(oscar_season) %>%
  summarize(mean=mean(audience_score), sd=sd(audience_score),median=median(audience_score),IQR=IQR(audience_score),min=min(audience_score),max=max(audience_score), count=n())
```

<span style="color:blue">Interpretation: There is an obvious difference in the distribution of audience score between movies that are released on </span>
<span style="color:blue;font-weight:bold">oscar_season</span>
<span style="color:blue"> and those that are not. The movies that are released on </span>
<span style="color:blue;font-weight:bold">oscar_season</span>
<span style="color:blue"> has higher audience score by 2.322 on average compared to the rest.</span>
<br> </br>

* * *

## Part 4: Modeling

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button above. Make sure that your code is visible in the project you submit. 
Delete this note when before you submit your work.

* * *

## Part 5: Prediction

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button above. Make sure that your code is visible in the project you submit. 
Delete this note when before you submit your work.

* * *

## Part 6: Conclusion

