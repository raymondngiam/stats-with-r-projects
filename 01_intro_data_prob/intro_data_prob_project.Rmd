---
title: "Exploring the BRFSS data"
author: "Raymond Ngiam"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
```

### Load data

```{r load-data}
load("brfss2013.RData")
```



* * *

## Part 1: Data

**How the observations in the sample are collected:**

BRFSS conducts both landline telephone- and cellular telephone-based surveys.  Stratified sampling is used in landline telephone-based surveys, while simple random sampling is used in cellular telephone-based surveys.

**Implications of this data collection method on the scope of inference (generalizability):**

Since the data collection, both landline telephone- and cellular telephone-based surveys involve some form of random sampling, the sample can be considered representative of the population. Hence findings from this observational study can be generalized to the entire population.

**Implications of this data collection method on the scope of inference (causality):**

Since this is an observational study, not an experiment where subjects are randomly assigned for specific treatments, hence, the findings on relationship among different factors only establish association but do not imply causality.

* * *

## Part 2: Research questions

**Research quesion 1: What are the health care coverage ratio across different income levels for men and women?**

This research question is of interest because we can observe whether are there differences in proportion of people with health care coverage for different income levels. 

**Research quesion 2: What are the flu shot in the past 12 months ratio across different income levels for men and women?**

This research question is of interest because we can observe whether are there differences in proportion of people with flu shot in the past 12 months for different income levels.


**Research quesion 3: What is the percentage distribution of Body Mass Index (BMI) classes, i.e. "Underweight","Normal", "Overweight", and "Obesity", for men and women.**

This research question is of interest because we can know the proportion of men and women which are in different BMI classes.

* * *

## Part 3: Exploratory data analysis

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button (green button with orange arrow) above. Make sure that your code is visible
in the project you submit. Delete this note when before you submit your work.

**Research quesion 1: What are the health care coverage ratio across different income levels for men and women?**

The dataset is divided by sex into 2 sets, and entry with not applicable (NA) cell for income and health care coverage column are filtered.

```{r}
q1_male_brfss2013 <- brfss2013 %>%
  filter(sex == "Male", !(is.na(income2)),!(is.na(hlthpln1)))
q1_female_brfss2013 <- brfss2013 %>%
  filter(sex == "Female", !(is.na(income2)),!(is.na(hlthpln1)))
```

Bar plot for Male's health care coverage (hlthpln1) against income level (income2)

```{r}
ggplot(data = q1_male_brfss2013, aes(x = income2, fill = hlthpln1)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(title = "Male's Health care coverage (hlthpln1) against Income level (income2)")
```

Summary statistics for Male's health care coverage (hlthpln1) grouped by income level (income2)

```{r}
q1_male_result <- q1_male_brfss2013 %>%
  group_by(income2) %>%
  summarise(hlthpln1_rate = sum(hlthpln1 == "Yes") / n()) %>%
  arrange(desc(hlthpln1_rate))
q1_male_result
```
<span style="color:blue">Interpretation: There is a positive correlation between income level and male's health care coverage. </span>

Bar plot for Female's health care coverage (hlthpln1) against income level (income2)

```{r}
ggplot(data = q1_female_brfss2013, aes(x = income2, fill = hlthpln1)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(title = "Female's Health care coverage (hlthpln1) against Income level (income2)")
```

Summary statistics for Female's health care coverage (hlthpln1) grouped by income level (income2)

```{r}
q1_female_result <- q1_female_brfss2013 %>%
  group_by(income2) %>%
  summarise(hlthpln1_rate = sum(hlthpln1 == "Yes") / n()) %>%
  arrange(desc(hlthpln1_rate))
q1_female_result

```
<span style="color:blue">Interpretation: There is a positive correlation between income level and female's health care coverage.</span>



**Research quesion 2: What are the flu shot in the past 12 months ratio across different income levels for men and women?**

The dataset is divided by sex into 2 sets, and entry with not applicable (NA) cell for income and flu shot column are filtered.

```{r}
q2_male_brfss2013 <- brfss2013 %>%
  filter(sex == "Male", !(is.na(income2)),!(is.na(flushot6)))
q2_female_brfss2013 <- brfss2013 %>%
  filter(sex == "Female", !(is.na(income2)),!(is.na(flushot6)))
```

Bar plot for Male's flu shot in past 12 months (flushot6) against income level (income2)

```{r}
ggplot(data = q2_male_brfss2013, aes(x = income2, fill = flushot6)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(title = "Male's Flu shot in past 12 months (flushot6) against Income level (income2)")
```

Summary statistics for Male's flu shot (flushot6) grouped by income level (income2)

```{r}
q2_male_result <- q2_male_brfss2013 %>%
  group_by(income2) %>%
  summarise(flushot6_rate = sum(flushot6 == "Yes") / n()) %>%
  arrange(desc(flushot6_rate))
q2_male_result
```
<span style="color:blue">Interpretation: There is a positive correlation between income level and male's flu shot in past 12 months. </span>

Bar plot for Female's flu shot in past 12 months (flushot6) against income level (income2)

```{r}
ggplot(data = q2_female_brfss2013, aes(x = income2, fill = flushot6)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(title = "Female's Flu shot in past 12 months (flushot6) against Income level (income2)")
```

Summary statistics for Female's flu shot (flushot6) grouped by income level (income2)

```{r}
q2_female_result <- q2_female_brfss2013 %>%
  group_by(income2) %>%
  summarise(flushot6_rate = sum(flushot6 == "Yes") / n()) %>%
  arrange(desc(flushot6_rate))
q2_female_result
```
<span style="color:blue">Interpretation: There is a positive correlation between income level and female's flu shot in past 12 months. </span>



**Research quesion 3:**

```{r}

```

